LANG = 'zh'

def tr(key, **kwargs):
    """统一的翻译函数"""
    s = ALL_TRANSLATIONS.get(LANG, ALL_TRANSLATIONS['zh']).get(key, key)
    return s.format(**kwargs) if kwargs else s

def set_language(lang):
    """设置全局语言"""
    global LANG
    LANG = lang
    
def get_language():
    """获取当前语言"""
    return LANG

ALL_TRANSLATIONS = {
    'zh': {
        # GUI 相关
        'title': '照片去重与增补工具',
        'duplication_analysis': '去重检查',
        'supplement_analysis': '增补检查',
        'load_report': '加载报告',
        'delete': '直接删除',
        'select_all': '所有组全选',
        'unselect_all': '所有组全不选',
        'batch_select': '批量选择:',
        'keep_first': '保留第一个',
        'keep_newest': '保留最新',
        'keep_largest': '保留最大',
        'img_tab': '图片重复组',
        'vid_tab': '视频重复组',
        'supp_tab': '增补结果',
        'move_supp_img': '批量移动增补图片到指定目录',
        'move_supp_vid': '批量移动增补视频到指定目录',
        'select_main_folder': '选择主文件夹',
        'select_supp_folder': '选择补充文件夹',
        'select_target_folder': '选择待去重文件夹',
        'save_dedup_report_as': '保存去重报告为',
        'save_supp_report_as': '保存增补报告为',
        'text_files': 'Text Files (*.txt)',
        'param_error': '参数错误',
        'main_supp_same': '主文件夹和补充文件夹不能相同，请重新选择！',
        'no_files_to_move': '没有可移动的增补{label}。',
        'target_dir_not_found': '未能从报告中识别出增补{label}的目标目录。',
        'target_dir_create_fail': '目标目录不存在且创建失败：\n{target_dir}\n错误信息：{err}',
        'move_success': '成功移动 {count} 个{label}到\n{target_dir}',
        'move_corrupt': '\n其中 {corrupt} 个疑似损坏文件已移动到: {corrupt_dir}',
        'move_failed': '有 {count} 个{label}移动失败。\n{files}',
        'batch_move': '批量移动',
        'partial_move_failed': '部分移动失败',
        'select_report': '选择去重报告',
        'select_report_tip': 'Text Files (*.txt)',
        'file_not_exist': '文件不存在',
        'cannot_load_image': '无法加载图片',
        'no_thumbnail': '无缩略图',
        'keep': '保留',
        'group': '重复组',
        'video_group': '视频组',
        'supplement_report': '增补图片报告',
        'already_exists': '已存在',
        'dry_run': '[DRY-RUN] 只读模式，未做任何实际写入操作',
        'corrupted_files': '损坏文件',
        'stat_dedup': '[统计] 去重分析：',
        'stat_supp': '[统计] 增补分析：',
        'main_scanned': '主库共扫描: {count} 个文件',
        'supp_scanned': '补充库共扫描: {count} 个文件',
        'img_total': '总扫描图片: {count} 张',
        'img_del': '预计可删除: {count} 张',
        'img_save': '预计节省空间: {size:.2f} MB',
        'img_corrupt': '疑似损坏图片: {count} 张',
        'vid_total': '总扫描视频: {count} 个',
        'vid_del': '预计可删除: {count} 个',
        'vid_save': '预计节省空间: {size:.2f} MB',
        'vid_corrupt': '疑似损坏视频: {count} 个',
        'supp_img': '需增补图片: {count} 张',
        'supp_img_save': '预计增补空间: {size:.2f} MB',
        'supp_img_corrupt': '疑似损坏图片: {count}',
        'supp_vid': '需增补视频: {count} 个',
        'supp_vid_save': '预计增补空间: {size:.2f} MB',
        'supp_vid_corrupt': '疑似损坏视频: {count}',
        'elapsed': '分析/报告生成耗时: {sec:.1f} 秒',
        'report_done': '报告生成完成',
        'start_dedup': '开始生成去重报告...',
        'dedup_done': '报告生成完成: {path}',
        'start_supp': '开始生成增补报告...',
        'supp_done': '增补报告生成完成: {path}',
        'error': '发生错误: {err}\n{tb}',
        'choose_language': '语言/Language:',
        'corrupted': '损坏',
        'delete_corrupted': '删除损坏图片',
        'no_files_to_delete': '没有要删除的文件',
        'confirm_delete': '确认删除',
        'confirm_delete_msg': '确认删除',
        'files': '个文件',
        'delete_complete': '删除完成',
        'delete_complete_msg': '成功删除',
        'partial_delete_failed': '部分删除失败',
        'partial_delete_failed_msg': '部分删除失败',
        'delete_failed': '删除失败',
        'file_not_found': '文件不存在',
        'selected_target_folder': '选择的目标文件夹',
        'selected_main_folder': '选择的主文件夹',
        'selected_supp_folder': '选择的补充文件夹',
        'img': '图片',
        'vid': '视频',
        'to': '到',
        'supp_img_report': '增补图片报告',
        'partial_move_failed_msg': '部分移动失败',
        'move_corrupt': '移动损坏文件',

        # 后端处理相关（原 compare.py 中的内容）
                'log_config': '日志配置',
        'hash_desc': '计算图片文件的哈希值，支持 md5/sha1。',
        'img_collect': '递归收集文件夹下所有图片文件路径、大小、尺寸。',
        'img_collect_ret': '返回：[{path, size, shape}...]',
        'img_found': '共发现图片文件 {count} 张',
        'img_meta': '成功读取元数据图片数: {count}',
        'img_size_fail': '无法读取图片尺寸, 错误: {err}',
        'img_size_fail2': '无法读取图片尺寸: {path}, 错误: {err}',
        'file_size_fail': '无法读取文件大小: {path}, 错误: {err}',
        'vid_collect': '递归收集文件夹下所有视频文件路径、大小、文件名。',
        'vid_collect_ret': '返回：[{path, size, name}...]',
        'vid_found': '共发现视频文件 {count} 个',
        'vid_meta': '成功读取元数据视频数: {count}',
        'vid_info_fail': '无法读取视频文件信息: {path}, 错误: {err}',
        'hash_fail': '哈希计算失败: {path}, 错误: {err}',
        'dedup_desc': '去重模式主流程：查找重复图片和视频并输出报告。',
        'dry_run': '[DRY-RUN] 当前为只读模式，不会对任何文件做写入操作。',
        'group_count': '分组后需进一步比对的组数: {count}',
        'group_processing': '正在处理分组: 大小={size}, 尺寸={shape}, 文件数={count}',
        'dedup_done': '去重完成，报告已保存到: {path}',
        'supp_desc': '增补模式主流程：补充图片和视频并输出报告。',
        'main_img_count': '主文件夹图片数: {main}, 补充文件夹图片数: {supp}',
        'main_hash_done': '主文件夹哈希集合构建完成，唯一图片数: {count}',
        'supp_dir': '补充图片_{timestamp}',
        'supp_hash_fail': '补充图片哈希失败，跳过: {path',
        'supp_exists': '已存在，未增补: {path}',
        'disk_space': '增补图片总大小: {size:.2f} MB, 目标磁盘剩余空间: {free:.2f} MB',
        'disk_full': '磁盘空间不足，操作中止！',
        'disk_full_exc': '磁盘空间不足，无法完成增补操作！',
        'dry_run_supp': '[DRY-RUN] 预演增补: {src} -> {dst}',
        'supp_copy': '增补图片: {src} -> {dst}',
        'supp_copy_fail': '复制图片失败: {src} -> {dst}, 错误: {err}',
        'vid_supp_exists': '已存在视频，未增补: {path}',
        'dry_run_vid': '[DRY-RUN] 预演增补视频: {src} -> {dst}',
        'vid_supp_copy': '增补视频: {src} -> {dst}',
        'vid_supp_copy_fail': '复制视频失败: {src} -> {dst}, 错误: {err}',
        'dedup_img_group': '重复图片组{group_id} (哈希: {h}):',
        'dedup_vid_header': '\n重复视频文件：\n',
        'dedup_vid_group': '视频重复组{idx}:',
        'supp_report': '增补图片报告',
        'supp_img_success': '成功增补 {count} 张图片到: {dir}',
        'supp_img_exists': '已存在（未增补）{count} 张图片：',
        'supp_vid_success': '成功增补 {count} 个视频到: {dir}',
        'supp_vid_exists': '已存在（未增补）{count} 个视频：',
        'en_dash': '：',
        'scanning_images': '正在扫描图片文件...',
        'images_found': '发现图片文件 {count} 张',
        'scanning_videos': '正在扫描视频文件...',
        'videos_found': '发现视频文件 {count} 个',
        'analyzing_duplicates': '正在分析重复文件，共 {count} 组待处理...',
        'analysis_complete': '分析完成',
    },
    'en': {
        # GUI 相关  
        'title': 'Photo Deduplication & Supplement Tool',
        'duplication_analysis': 'Duplication Analysis',
        'supplement_analysis': 'Supplement Analysis',
        'load_report': 'Load Report',
        'delete': 'Delete Directly',
        'select_all': 'Select All Groups',
        'unselect_all': 'Unselect All Groups',
        'batch_select': 'Batch Select:',
        'keep_first': 'Keep First',
        'keep_newest': 'Keep Newest',
        'keep_largest': 'Keep Largest',
        'img_tab': 'Image Groups',
        'vid_tab': 'Video Groups',
        'supp_tab': 'Supplement Result',
        'move_supp_img': 'Batch Move Supplemented Images',
        'move_supp_vid': 'Batch Move Supplemented Videos',
        'select_main_folder': 'Select Main Folder',
        'select_supp_folder': 'Select Supplement Folder',
        'select_target_folder': 'Select Target Folder',
        'save_dedup_report_as': 'Save Deduplicate Report As',
        'save_supp_report_as': 'Save Supplement Report As',
        'text_files': 'Text Files (*.txt)',
        'param_error': 'Parameter Error',
        'main_supp_same': 'Main and supplement folders cannot be the same. Please reselect!',
        'no_files_to_move': 'No supplement {label} to move.',
        'target_dir_not_found': 'Failed to detect target directory for supplement {label} from report.',
        'target_dir_create_fail': 'Target directory does not exist and creation failed:\n{target_dir}\nError: {err}',
        'move_success': 'Successfully moved {count} {label} to\n{target_dir}',
        'move_corrupt': '\n{corrupt} suspected corrupted files moved to: {corrupt_dir}',
        'move_failed': '{count} {label} failed to move.\n{files}',
        'batch_move': 'Batch Move',
        'partial_move_failed': 'Partial Move Failed',
        'select_report': 'Select Deduplication Report',
        'select_report_tip': 'Text Files (*.txt)',
        'file_not_exist': 'File Not Exist',
        'cannot_load_image': 'Cannot Load Image',
        'no_thumbnail': 'No Thumbnail',
        'keep': 'Keep',
        'group': 'Group',
        'video_group': 'Video Group',
        'supplement_report': 'Supplement Report',
        'already_exists': 'Already Exists',
        'dry_run': '[DRY-RUN] Readonly mode, no actual file operation',
        'corrupted_files': 'Corrupted Files',
        'stat_dedup': '[Stats] Deduplication:',
        'stat_supp': '[Stats] Supplement:',
        'main_scanned': 'Main scanned: {count} files',
        'supp_scanned': 'Supplement scanned: {count} files',
        'img_total': 'Total images: {count}',
        'img_del': 'Deletable: {count}',
        'img_save': 'Space to save: {size:.2f} MB',
        'img_corrupt': 'Suspected corrupted images: {count}',
        'vid_total': 'Total videos: {count}',
        'vid_del': 'Deletable: {count}',
        'vid_save': 'Space to save: {size:.2f} MB',
        'vid_corrupt': 'Suspected corrupted videos: {count}',
        'supp_img': 'Images to supplement: {count}',
        'supp_img_save': 'Space to supplement: {size:.2f} MB',
        'supp_img_corrupt': 'Suspected corrupted images: {count}',
        'supp_vid': 'Videos to supplement: {count}',
        'supp_vid_save': 'Space to supplement: {size:.2f} MB',
        'supp_vid_corrupt': 'Suspected corrupted videos: {count}',
        'elapsed': 'Elapsed: {sec:.1f} s',
        'report_done': 'Report generated',
        'start_dedup': 'Generating deduplication report...',
        'dedup_done': 'Report generated: {path}',
        'start_supp': 'Generating supplement report...',
        'supp_done': 'Supplement report generated: {path}',
        'error': 'Error: {err}\n{tb}',
        'choose_language': 'Language:',
        'corrupted': 'Corrupted',
        'delete_corrupted': 'Delete Corrupted Images',
        'no_files_to_delete': 'No files to delete',
        'confirm_delete': 'Confirm Delete',
        'confirm_delete_msg': 'Confirm delete',
        'files': 'files',
        'delete_complete': 'Delete Complete',
        'delete_complete_msg': 'Successfully deleted',
        'partial_delete_failed': 'Partial Delete Failed',
        'partial_delete_failed_msg': 'Partial delete failed',
        'delete_failed': 'delete failed',
        'file_not_found': 'File not found',
        'selected_target_folder': 'Selected target folder',
        'selected_main_folder': 'Selected main folder',
        'selected_supp_folder': 'Selected supplement folder',
        'img': 'images',
        'vid': 'videos',
        'to': 'to',
        'supp_img_report': 'Supplement Report',
        'partial_move_failed_msg': 'Partial move failed',
        'move_corrupt': 'Move corrupted',


        # 后端处理相关
        'log_config': 'Log config',
        'hash_desc': 'Calculate image file hash, supports md5/sha1.',
        'img_collect': 'Recursively collect all image file paths, sizes, and shapes in folder.',
        'img_collect_ret': 'Return: [{path, size, shape}...]',
        'img_found': 'Found {count} image files',
        'img_meta': 'Successfully read metadata for {count} images',
        'img_size_fail': 'Failed to read image size, error: {err}',
        'img_size_fail2': 'Failed to read image size: {path}, error: {err}',
        'file_size_fail': 'Failed to read file size: {path}, error: {err}',
        'vid_collect': 'Recursively collect all video file paths, sizes, and names in folder.',
        'vid_collect_ret': 'Return: [{path, size, name}...]',
        'vid_found': 'Found {count} video files',
        'vid_meta': 'Successfully read metadata for {count} videos',
        'vid_info_fail': 'Failed to read video file info: {path}, error: {err}',
        'hash_fail': 'Hash calculation failed: {path}, error: {err}',
        'dedup_desc': 'Deduplication main flow: find duplicate images/videos and output report.',
        'dry_run': '[DRY-RUN] Readonly mode, no actual file operation.',
        'group_count': 'Groups to further compare: {count}',
        'group_processing': 'Processing group: size={size}, shape={shape}, count={count}',
        'dedup_done': 'Deduplication done, report saved to: {path}',
        'supp_desc': 'Supplement main flow: supplement images/videos and output report.',
        'main_img_count': 'Main folder images: {main}, supplement folder images: {supp}',
        'main_hash_done': 'Main folder hash set built, unique images: {count}',
        'supp_dir': 'supplement_{timestamp}',
        'supp_hash_fail': 'Supplement image hash failed, skip: {path}',
        'supp_exists': 'Already exists, not supplemented: {path}',
        'disk_space': 'Supplement images total size: {size:.2f} MB, target disk free: {free:.2f} MB',
        'disk_full': 'Disk space not enough, abort!',
        'disk_full_exc': 'Disk space not enough, cannot complete supplement!',
        'dry_run_supp': '[DRY-RUN] Simulate supplement: {src} -> {dst}',
        'supp_copy': 'Supplement image: {src} -> {dst}',
        'supp_copy_fail': 'Copy image failed: {src} -> {dst}, error: {err}',
        'vid_supp_exists': 'Video already exists, not supplemented: {path}',
        'dry_run_vid': '[DRY-RUN] Simulate supplement video: {src} -> {dst}',
        'vid_supp_copy': 'Supplement video: {src} -> {dst}',
        'vid_supp_copy_fail': 'Copy video failed: {src} -> {dst}, error: {err}',
        'dedup_img_group': 'Duplicate Image Group {group_id} (hash: {h}):',
        'dedup_vid_header': '\nDuplicate Videos:\n',
        'dedup_vid_group': 'Duplicate Video Group {idx}:',
        'supp_report': 'Supplement Report',
        'supp_img_success': 'Supplemented {count} images to: {dir}',
        'supp_img_exists': 'Already exists (not supplemented) {count} images:',
        'supp_vid_success': 'Supplemented {count} videos to: {dir}',
        'supp_vid_exists': 'Already exists (not supplemented) {count} videos:',
        'en_dash': ':',
        'scanning_images': 'Scanning image files...',
        'images_found': 'Found {count} image files',
        'scanning_videos': 'Scanning video files...',
        'videos_found': 'Found {count} video files',
        'analyzing_duplicates': 'Analyzing duplicates, {count} groups to process...',
        'analysis_complete': 'Analysis complete',

    }
}


